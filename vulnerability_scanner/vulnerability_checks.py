import nmap
import logging

def check_ip_vulnerabilities(ip):
    scanner = nmap.PortScanner()
    try:
        # Example: Scan ports 22 to 80
        scan_result = scanner.scan(ip, '22-80')
        open_ports = scan_result.get("scan", {}).get(ip, {}).get("tcp", {})
        vulnerabilities = []
        
        # Check for open ports and add to vulnerabilities list
        for port in open_ports:
            if open_ports[port].get("state") == "open":
                vulnerabilities.append(f"Open port {port}")
        
        return vulnerabilities
    except Exception as e:
        logging.error(f"Error scanning {ip}: {str(e)}")
        return []
