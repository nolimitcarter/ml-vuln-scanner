import logging
from vulnerability_scanner.vulnerability_checks import check_ip_vulnerabilities
from vulnerability_scanner.data_preprocessing import preprocess_data

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Sample data
data = [
    {'ip': '172.26.174.33', 'other_features': [0, 1]},
    {'ip': '192.168.01.2', 'other_features': [1, 0]},
    {'ip': '192.168.01.51', 'other_features': [0, 1]},
    {'ip': 'network', 'other_features': [0, 0]}
]

# Preprocess the data
processed_data = preprocess_data(data)

# Now scan each IP
logger.info("Starting vulnerability scanning...")
for row in processed_data:
    ip = row['ip']
    logger.info(f"Scanning IP: {ip}")
    
    if ip != "invalid_ip":
        result = check_ip_vulnerabilities(ip)
        if result is None:
            logger.info(f"Failed to scan IP: {ip}")
        else:
            logger.info(f"Scan completed for {ip}")
    else:
        logger.warning(f"Skipping invalid IP: {ip}")

logger.info("Scanning process completed!")
