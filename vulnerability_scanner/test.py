import requests
import os

def test_nvd_api_connection(api_key):
    url = 'https://services.nvd.nist.gov/rest/json/cves/2.0/'
    headers = {'apiKey': api_key}
    print(f"Requesting URL: {url}")
    response = requests.get(url, headers=headers)
    
    if response.status_code == 200:
        print("Successfully connected to the NVD API.")
        print(response.json())
    elif response.status_code == 404:
        print("API endpoint not found. Please check the URL.")
    elif response.status_code == 403:
        print("Access forbidden. Please check your API key and permissions.")
    else:
        print(f"Failed to connect to the NVD API. Status code: {response.status_code}")

if __name__ == "__main__":
    api_key = os.getenv('NVD_API_KEY')  # Fetch the API key from environment variable
    if not api_key:
        print("API key not found. Please set the NVD_API_KEY environment variable.")
    else:
        test_nvd_api_connection(api_key)

